# æ­£æ­£å…¬å¸å‘˜å·¥è®°å¿†åº“ç³»ç»Ÿ - ä½¿ç”¨æ‰‹å†Œ

## ğŸ“– æ¦‚è¿°

è®°å¿†åº“ç³»ç»Ÿä¸ºæ­£æ­£å…¬å¸çš„æ¯ä½å‘˜å·¥æä¾›æŒä¹…åŒ–è®°å¿†èƒ½åŠ›ï¼Œç¡®ä¿è·¨ä¼šè¯çŸ¥è¯†è¿ç»­æ€§ã€‚

**ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2026-02-13

---

## ğŸ—ï¸ æ¶æ„è¯´æ˜

### ç›®å½•ç»“æ„

```
.agent/
â”œâ”€â”€ è®°å¿†åº“ç³»ç»Ÿ/
â”‚   â”œâ”€â”€ æ ¸å¿ƒæ¨¡å—/
â”‚   â”‚   â””â”€â”€ memory_manager.py     # MemoryManagerç±»
â”‚   â”œâ”€â”€ è‡ªåŠ¨åŒ–è„šæœ¬/
â”‚   â”‚   â””â”€â”€ memory_maintenance.py  # ç»´æŠ¤è„šæœ¬
â”‚   â””â”€â”€ å·¥å…·è„šæœ¬/
â”‚       â””â”€â”€ init_employees.py      # åˆå§‹åŒ–è„šæœ¬
â””â”€â”€ å‘˜å·¥/
    â”œâ”€â”€ å¤§æ²³/
    â”‚   â””â”€â”€ è®°å¿†åº“/
    â”‚       â”œâ”€â”€ work_log.md        # å·¥ä½œæ—¥å¿—
    â”‚       â”œâ”€â”€ relations.md       # äººé™…å…³ç³»
    â”‚       â”œâ”€â”€ learnings.md       # æŠ€èƒ½ç»éªŒ
    â”‚       â”œâ”€â”€ index.json         # ç´¢å¼•
    â”‚       â””â”€â”€ å½’æ¡£/
    â”‚           â””â”€â”€ 2026-01/       # æŒ‰æœˆå½’æ¡£
    â”œâ”€â”€ æµ·ç±³/è®°å¿†åº“/...
    â””â”€â”€ å›°å›°/è®°å¿†åº“/...
```

### æ ¸å¿ƒç‰¹æ€§

1. **ä¸‰æ¡£æ¡ˆåˆ†ç¦»**: å·¥ä½œæ—¥å¿—ã€äººé™…å…³ç³»ã€æŠ€èƒ½ç»éªŒç‹¬ç«‹ç®¡ç†
2. **è‡ªåŠ¨å½’æ¡£**: æ¯æœˆè‡ªåŠ¨å°†å·¥ä½œæ—¥å¿—å½’æ¡£
3. **è·¨å‘˜å·¥è®¿é—®**: æ ¸å¿ƒå‘˜å·¥å¯äº’ç›¸æŸ¥çœ‹è®°å¿†
4. **æ ¼å¼æ ¡éªŒ**: è‡ªåŠ¨æ£€æµ‹å¹¶ä¿®å¤æ ¼å¼é—®é¢˜
5. **é›¶ç»´æŠ¤**: è‡ªåŠ¨åŒ–è„šæœ¬å¤„ç†æ‰€æœ‰ç»´æŠ¤ä»»åŠ¡

---

## ğŸ‘¤ å‘˜å·¥ä½¿ç”¨æŒ‡å—

### åŸºæœ¬ç”¨æ³•

#### 1. å†™å…¥å·¥ä½œæ—¥å¿—

```python
import sys
sys.path.insert(0, '.agent/è®°å¿†åº“ç³»ç»Ÿ/æ ¸å¿ƒæ¨¡å—')
from memory_manager import MemoryManager

manager = MemoryManager("å¤§æ²³")

# æ·»åŠ å·¥ä½œè®°å½•
manager.add_work_log(
    content="ä¸ºæ­£æ­£æ‹›è˜äº†æ–°å‘˜å·¥å°ç™½ï¼ˆä¸€åªå…”å­ï¼‰",
    tags=["æ‹›è˜", "æˆåŠŸ"],
    importance=4
)
```

#### 2. æ·»åŠ äººé™…å…³ç³»

```python
manager.add_relation(
    person="å°ç™½",
    relationship="æ–°å‘˜å·¥ï¼ˆå…”å­ï¼‰ï¼Œæ“…é•¿æ–‡æ¡£æ•´ç†",
    notes="æ€§æ ¼æ¸©å’Œï¼Œæ‰§è¡ŒåŠ›å¼º"
)
```

#### 3. è®°å½•æŠ€èƒ½ç»éªŒ

```python
manager.add_learning(
    content="å‘ç°ä½¿ç”¨4Dé¢è¯•æ³•èƒ½æ›´å‡†ç¡®åœ°è¯†åˆ«å‘˜å·¥ç‰¹è´¨",
    category="æ‹›è˜æŠ€å·§",
    importance=5
)
```

#### 4. è¯»å–è‡ªå·±çš„è®°å¿†

```python
# è·å–æœ€è¿‘2ä¸ªæœˆçš„å·¥ä½œæ—¥å¿—
work_logs = manager.read_work_log(months=2)

# è·å–è®°å¿†æ‘˜è¦ï¼ˆç”¨äºåŠ è½½åˆ°ä¸Šä¸‹æ–‡ï¼‰
summary = manager.get_memory_summary(max_entries=20)
print(summary)
```

#### 5. æŸ¥çœ‹å…¶ä»–æ ¸å¿ƒå‘˜å·¥è®°å¿†

```python
from memory_manager import CrossEmployeeMemory

cross_memory = CrossEmployeeMemory()

# æŸ¥çœ‹å›°å›°çš„è®°å¿†
kunkun_memory = cross_memory.read_employee_memory("å›°å›°", "å¤§æ²³")
print(kunkun_memory)

# æŸ¥çœ‹æ‰€æœ‰æ ¸å¿ƒå‘˜å·¥è®°å¿†
all_memories = cross_memory.list_core_memories("å¤§æ²³")
for emp, memory in all_memories.items():
    print(f"\n=== {emp} ===")
    print(memory)
```

---

## ğŸ”§ ç®¡ç†å‘˜ä½¿ç”¨æŒ‡å—

### åˆå§‹åŒ–æ–°å‘˜å·¥è®°å¿†åº“

```bash
cd .agent/è®°å¿†åº“ç³»ç»Ÿ/å·¥å…·è„šæœ¬
python init_employees.py
```

æˆ–åœ¨Pythonä¸­ï¼š

```python
from memory_manager import initialize_employee_memory

initialize_employee_memory("æ–°å‘˜å·¥åç§°")
```

### æ‰§è¡Œç»´æŠ¤ä»»åŠ¡

#### æ‰‹åŠ¨å½’æ¡£

```bash
cd .agent/è®°å¿†åº“ç³»ç»Ÿ/è‡ªåŠ¨åŒ–è„šæœ¬
python memory_maintenance.py --archive
```

#### å¥åº·æ£€æŸ¥

```bash
python memory_maintenance.py --health
```

#### å¤‡ä»½

```bash
python memory_maintenance.py --backup
```

#### ç”Ÿæˆç»Ÿè®¡æŠ¥å‘Š

```bash
python memory_maintenance.py --report
```

#### æ‰§è¡Œå…¨éƒ¨ç»´æŠ¤

```bash
python memory_maintenance.py --all
```

### å®šæ—¶ä»»åŠ¡é…ç½®

**Windows (ä»»åŠ¡è®¡åˆ’ç¨‹åº)**:
1. æ‰“å¼€"ä»»åŠ¡è®¡åˆ’ç¨‹åº"
2. åˆ›å»ºåŸºæœ¬ä»»åŠ¡
3. è§¦å‘å™¨: æ¯æœˆç¬¬ä¸€å¤© 0:00
4. æ“ä½œ: `python D:\opencode_project\.agent\è®°å¿†åº“ç³»ç»Ÿ\è‡ªåŠ¨åŒ–è„šæœ¬\memory_maintenance.py --all`

**Linux/Mac (crontab)**:
```bash
# æ¯æœˆ1å·å‡Œæ™¨æ‰§è¡Œ
0 0 1 * * cd /path/to/project && python .agent/è®°å¿†åº“ç³»ç»Ÿ/è‡ªåŠ¨åŒ–è„šæœ¬/memory_maintenance.py --all
```

---

## ğŸ“Š APIå‚è€ƒ

### MemoryManager ç±»

#### åˆå§‹åŒ–

```python
manager = MemoryManager(employee_name, base_path=".agent/å‘˜å·¥")
```

#### æ–¹æ³•

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `add_work_log` | `content, tags, importance` | `bool` | æ·»åŠ å·¥ä½œæ—¥å¿— |
| `add_relation` | `person, relationship, notes` | `bool` | æ·»åŠ äººé™…å…³ç³» |
| `add_learning` | `content, category, importance` | `bool` | æ·»åŠ æŠ€èƒ½ç»éªŒ |
| `read_work_log` | `months, include_archived` | `List[MemoryEntry]` | è¯»å–å·¥ä½œæ—¥å¿— |
| `read_relations` | - | `List[MemoryEntry]` | è¯»å–äººé™…å…³ç³» |
| `read_learnings` | - | `List[MemoryEntry]` | è¯»å–æŠ€èƒ½ç»éªŒ |
| `get_memory_summary` | `max_entries` | `str` | è·å–è®°å¿†æ‘˜è¦ |
| `archive_current_month` | - | `bool` | å½’æ¡£å½“å‰æœˆ |
| `validate_and_fix` | - | `Tuple[bool, List[str]]` | éªŒè¯å¹¶ä¿®å¤æ ¼å¼ |

### CrossEmployeeMemory ç±»

```python
cross_memory = CrossEmployeeMemory(base_path=".agent/å‘˜å·¥")

# è¯»å–å…¶ä»–å‘˜å·¥è®°å¿†ï¼ˆéœ€æƒé™ï¼‰
memory = cross_memory.read_employee_memory(employee_name, requester)

# åˆ—å‡ºæ‰€æœ‰æ ¸å¿ƒå‘˜å·¥è®°å¿†
memories = cross_memory.list_core_memories(requester)
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. ä½•æ—¶å†™è®°å¿†ï¼Ÿ

- âœ… å®Œæˆä¸€ä¸ªå®Œæ•´ä»»åŠ¡å
- âœ… å­¦åˆ°æ–°çŸ¥è¯†æˆ–æŠ€èƒ½
- âœ… é‡åˆ°é‡è¦çš„äººæˆ–äº‹ä»¶
- âŒ ä¸è¦è®°å½•çç¢ç»†èŠ‚
- âŒ ä¸è¦è®°å½•ä¸´æ—¶/ä¸€æ¬¡æ€§ä¿¡æ¯

**è¡¥å……ï¼ˆè½»é‡è®°å¿†ï¼‰**ï¼š
- åªè®°å½•é•¿æœŸåå¥½ã€èƒŒæ™¯äº‹å®ã€æ˜ç¡®å†³å®šã€å¼ºçƒˆæƒ…ç»ª+åŸå› ã€å¯å¤ç”¨ä¿¡æ¯
- å†™å…¥å‰ä¼šè‡ªåŠ¨åšè¿‘é‚»å»é‡ï¼ˆé¿å…é‡å¤è®°å¿†ï¼‰
- é—²èŠæœ€å¤šä¿ç•™ 10 æ¡ï¼›æ–°å¢æ—¶éšæœºæ¸…ç† 1 æ¡æ—§è®°å½•

### 2. å¦‚ä½•å†™å¥½è®°å¿†ï¼Ÿ

**å·¥ä½œæ—¥å¿— - ç¤ºä¾‹**:
```python
# âœ… å¥½çš„è®°å½•
manager.add_work_log("å®Œæˆè®°å¿†åº“ç³»ç»Ÿå¼€å‘ï¼Œæ”¯æŒä¸‰æ¡£æ¡ˆ+è‡ªåŠ¨å½’æ¡£", tags=["å¼€å‘", "æ ¸å¿ƒ"], importance=5)

# âŒ ä¸å¥½çš„è®°å½•
manager.add_work_log("ä»Šå¤©å†™äº†å¾ˆå¤šä»£ç ç„¶åæµ‹è¯•äº†ä¸€ä¸‹å‘ç°æœ‰bugåˆä¿®äº†åŠå¤©æœ€åç»ˆäºæå®šäº†", importance=3)
```

**äººé™…å…³ç³» - ç¤ºä¾‹**:
```python
# âœ… å¥½çš„è®°å½•
manager.add_relation("å¼ ä¸‰", "æ•°æ®åˆ†æå¸ˆ", "æ“…é•¿Pythonå’ŒSQLï¼Œåä½œé¡ºç•…")

# âŒ ä¸å¥½çš„è®°å½•
manager.add_relation("å¼ ä¸‰", "åŒäº‹", "")
```

**æŠ€èƒ½ç»éªŒ - ç¤ºä¾‹**:
```python
# âœ… å¥½çš„è®°å½•
manager.add_learning("Python pathlibæ¯”os.pathæ›´å®‰å…¨ï¼Œè‡ªåŠ¨å¤„ç†è·¯å¾„åˆ†éš”ç¬¦", "Python", importance=4)

# âŒ ä¸å¥½çš„è®°å½•
manager.add_learning("å­¦äº†Python", importance=3)
```

### 3. é‡è¦æ€§ç­‰çº§å»ºè®®

| ç­‰çº§ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| 5 â­â­â­â­â­ | é‡Œç¨‹ç¢‘äº‹ä»¶ | å®Œæˆæ ¸å¿ƒç³»ç»Ÿã€é‡å¤§å†³ç­– |
| 4 â­â­â­â­ | é‡è¦å·¥ä½œ | è§£å†³å¤æ‚é—®é¢˜ã€å­¦åˆ°å…³é”®æŠ€èƒ½ |
| 3 â­â­â­ | å¸¸è§„å·¥ä½œ | æ—¥å¸¸ä»»åŠ¡ã€å°æ”¹è¿› |
| 2 â­â­ | æ¬¡è¦äº‹é¡¹ | è¾…åŠ©å·¥ä½œ |
| 1 â­ | çç¢äº‹é¡¹ | ä¸å»ºè®®è®°å½• |

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1: å†™å…¥å¤±è´¥

**ç—‡çŠ¶**: `add_work_log` è¿”å› `False`

**å¯èƒ½åŸå› **:
1. è®°å¿†åº“ç›®å½•ä¸å­˜åœ¨
2. æ–‡ä»¶æƒé™é—®é¢˜
3. ç£ç›˜å·²æ»¡

**è§£å†³æ–¹æ¡ˆ**:
```python
# é‡æ–°åˆå§‹åŒ–è®°å¿†åº“
from memory_manager import initialize_employee_memory
initialize_employee_memory("å‘˜å·¥å")

# éªŒè¯å¹¶ä¿®å¤
manager = MemoryManager("å‘˜å·¥å")
is_valid, errors = manager.validate_and_fix()
print(errors)
```

### é—®é¢˜2: æ— æ³•è¯»å–å…¶ä»–å‘˜å·¥è®°å¿†

**ç—‡çŠ¶**: `read_employee_memory` è¿”å› `None`

**åŸå› **: æƒé™ä¸è¶³ï¼ˆéæ ¸å¿ƒå‘˜å·¥ï¼‰

**è§£å†³æ–¹æ¡ˆ**: åªæœ‰å¤§æ²³ã€æµ·ç±³ã€å›°å›°ä¸‰ä½æ ¸å¿ƒå‘˜å·¥å¯ä»¥äº’ç›¸æŸ¥çœ‹è®°å¿†ã€‚

### é—®é¢˜3: è®°å¿†åº“æ–‡ä»¶æ ¼å¼é”™è¯¯

**ç—‡çŠ¶**: è¯»å–æ—¶è§£æå¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```python
manager = MemoryManager("å‘˜å·¥å")
is_valid, errors = manager.validate_and_fix()
# ä¼šè‡ªåŠ¨ä¿®å¤å¸¸è§æ ¼å¼é—®é¢˜
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **æ–‡æ¡£**: æœ¬æ–‡ä»¶
- **æºä»£ç **: `.agent/è®°å¿†åº“ç³»ç»Ÿ/æ ¸å¿ƒæ¨¡å—/memory_manager.py`
- **é—®é¢˜åé¦ˆ**: è”ç³»æ­£æ­£ï¼ˆé¡¹ç›®è´Ÿè´£äººï¼‰

---

## ğŸ“œ æ›´æ–°æ—¥å¿—

### v1.0.0 (2026-02-13)
- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- ğŸ¯ ä¸‰æ¡£æ¡ˆè®°å¿†ç³»ç»Ÿ
- ğŸ¤– è‡ªåŠ¨å½’æ¡£ä¸ç»´æŠ¤
- ğŸ” è·¨å‘˜å·¥è®¿é—®æ§åˆ¶
- ğŸ“Š ç»Ÿè®¡æŠ¥å‘ŠåŠŸèƒ½
